<!doctype html><html lang=fr-fr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<title>Tchoupa-Team</title>
<link rel=stylesheet href=https://use.fontawesome.com/releases/v5.6.3/css/all.css integrity=sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/ crossorigin=anonymous>
<link rel=stylesheet href=https://tchoupapps.fr/css/bootstrap4-neon-glow.css>
<link href="https://fonts.googleapis.com/css?family=Roboto" rel=stylesheet>
<link rel=stylesheet href=https://tchoupapps.fr/css/main.css>
<link rel=stylesheet href=https://tchoupapps.fr/css/glitch.css>
<link rel=stylesheet href=https://tchoupapps.fr/css/menu.css>
<link rel=stylesheet href=https://tchoupapps.fr/css/member.css>
<link rel=stylesheet href=https://tchoupapps.fr/css/chall.css>
</head>}
<body class=imgloaded>
<header>
<div class=navbar-dark>
<div class="container menu">
<nav class="navbar px-0 navbar-expand-lg">
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNavAltMarkup aria-controls=navbarNavAltMarkup aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarNavAltMarkup>
<div class=navbar-nav>
<a href=index.html class="pl-md-0 p-3 text-decoration-none">
<h3 class=bold><span class=color_danger>TCHOUPA</span><span class=color_white>TEAM</span></h3>
</a>
</div>
<div class="navbar-nav ml-auto">
<a href=/ class="p-3 text-decoration-none text-dark bold">Home</a>
<a href=/posts class="p-3 text-decoration-none text-dark bold">Writeups</a>
<a href=/about class="p-3 text-decoration-none text-dark bold">About</a>
</div>
</div>
</nav>
</div>
</div>
</header>
<div class="jumbotron bg-transparent mb-0 pt-3 radius-0">
<div class=container>
<div class=row>
<div class=col-xl-12>
<h1 class="display-1 bold color_white content__title text-center"><span class=color_danger>PHILLIP2</span></h1>
<div class=cut>
</div>
<p class="text-spacey text-center hackerFont lead" style=color:gray> UMDCTF 2021 - forensic (794 pts).<br>Written by ChapeauR0uge.</p>
<div class=chall>
<h1 id=phillip-2>Phillip 2</h1>
<h2 id=description>Description</h2>
<p><img src=/files/umdctf21/phillip2/phillip2.PNG alt="Phillip 2 - UMDCTF'21"></p>
<p>We have 3 files in this challenge:</p>
<ul>
<li>module.dwarf</li>
<li>philip-2.raw.zip</li>
<li>System.map-5.8.0-25-generic</li>
</ul>
<p>The <code>module.dwarf</code> and <code>System.map</code> are the same than <code>phillip 1</code>, so I re-use the profile.</p>
<h2 id=solve>Solve</h2>
<p>Fristly, we are checking the bash history:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ sudo vol.py -f philip-2.raw --profile<span style=color:#f92672>=</span>Linux_phillipx64 linux_bash
NOTHING_FOUND
</code></pre></div><p>Ok, lets try to found and dump <code>.bash_history</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ sudo vol.py -f philip-2.raw --profile<span style=color:#f92672>=</span>Linux_phillipx64 linux_enumerate_files | grep /home/lubuntu/.bash_history
Volatility Foundation Volatility Framework 2.6.1
0xffff95f1c623fc30                      <span style=color:#ae81ff>5690</span> /cow/upper/home/lubuntu/.bash_history
$ sudo vol.py -f philip-2.raw --profile<span style=color:#f92672>=</span>Linux_phillipx64 linux_find_file -i 0xffff95f1c623fc30 -O bash_history
</code></pre></div><p>Lets check this history:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ cat bash_history                   
sudo apt update
sudo apt install thunderbird
clear
exit
</code></pre></div><p>It&rsquo;s just an <code>thunderbird</code> an email client installation, we trying to found all <code>thunderbird</code> files:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ sudo vol.py -f philip-2.raw --profile<span style=color:#f92672>=</span>Linux_phillipx64 linux_enumerate_files | grep /home/lubuntu/.sthunderbird
Volatility Foundation Volatility Framework 2.6.1
Volatility Foundation Volatility Framework 2.6.1
WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes
WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes
...
0xffff95f1f02473c0                      <span style=color:#ae81ff>6114</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/INBOX
0xffff95f1f0246e20                      <span style=color:#ae81ff>6099</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/INBOX.msf
0xffff95f1f0244120                      <span style=color:#ae81ff>6115</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/<span style=color:#f92672>[</span>Gmail<span style=color:#f92672>]</span>.sbd
0xffff95f1f0242aa0                      <span style=color:#ae81ff>6122</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/<span style=color:#f92672>[</span>Gmail<span style=color:#f92672>]</span>.sbd/Trash.msf
0xffff95f1c32099c0                      <span style=color:#ae81ff>6120</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/<span style=color:#f92672>[</span>Gmail<span style=color:#f92672>]</span>.sbd/Spam.msf
0xffff95f1c320f3c0                      <span style=color:#ae81ff>6012</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/<span style=color:#f92672>[</span>Gmail<span style=color:#f92672>]</span>.sbd/Drafts.msf
0xffff95f1f02408e0                      <span style=color:#ae81ff>6121</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/<span style=color:#f92672>[</span>Gmail<span style=color:#f92672>]</span>.sbd/Starred.msf
0xffff95f1f0240340                      <span style=color:#ae81ff>6119</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/<span style=color:#f92672>[</span>Gmail<span style=color:#f92672>]</span>.sbd/Sent Mail.msf
0xffff95f1f0242500                      <span style=color:#ae81ff>6118</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/<span style=color:#f92672>[</span>Gmail<span style=color:#f92672>]</span>.sbd/Important.msf
0xffff95f1f02435e0                      <span style=color:#ae81ff>6116</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/<span style=color:#f92672>[</span>Gmail<span style=color:#f92672>]</span>.sbd/All Mail.msf
0xffff95f1f0244c60                      <span style=color:#ae81ff>6113</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/<span style=color:#f92672>[</span>Gmail<span style=color:#f92672>]</span>.msf
0xffff95f1f0246b50                      <span style=color:#ae81ff>6100</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/Archives.msf
0xffff95f1f0247c30                      <span style=color:#ae81ff>6112</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/msgFilterRules.dat
0xffff95f1f0247960                      <span style=color:#ae81ff>6110</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/Sent.msf
0xffff95f1c623e5b0                      <span style=color:#ae81ff>6109</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/Templates.msf
0xffff95f1c5429150                      <span style=color:#ae81ff>6108</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com/Drafts.msf
0xffff95f1c320f0f0                      <span style=color:#ae81ff>6087</span> /cow/upper/home/lubuntu/.thunderbird/hlza10kp.default-release/ImapMail/imap.gmail.com.msf
...
</code></pre></div><p>They are many files, but only two very interesting: <code>INBOX</code> and <code>INBOX.msf</code>.</p>
<p>You can find more info about <code>.msf</code> <a href=https://www.bitrecover.com/free/thunderbird-msf-viewer/>here</a>.</p>
<p>With these two files, we can import this INBOX dump into our <code>thunderbird client</code>.</p>
<pre><code>$ mkdir local
$ sudo vol.py -f philip-2.raw --profile=Linux_phillipx64 linux_find_file -i 0xffff95f1f02473c0 -O local/INBOX
$ sudo vol.py -f philip-2.raw --profile=Linux_phillipx64 linux_find_file -i 0xffff95f1f0246e20 -O local/INBOX.msf
</code></pre><ul>
<li>A little tutorial for import:</li>
</ul>
<p><img src=/files/umdctf21/phillip2/tool.PNG alt="Phillip 2 - UMDCTF'21"></p>
<ul>
<li>You need to select the INBOX file.</li>
</ul>
<p><img src=/files/umdctf21/phillip2/mbox.PNG alt="Phillip 2 - UMDCTF'21"></p>
<ul>
<li>We found 5 email, but only two interesting.</li>
</ul>
<p><img src=/files/umdctf21/phillip2/mail1.PNG alt="Phillip 2 - UMDCTF'21"></p>
<ul>
<li>We have a <code>Invoice.zip</code> and a <code>password</code></li>
</ul>
<p><img src=/files/umdctf21/phillip2/chung1.PNG alt="Phillip 2 - UMDCTF'21"></p>
<ul>
<li>We unzip <code>invoice.zip</code> with the password</li>
</ul>
<p><img src=/files/umdctf21/phillip2/flag1.PNG alt="Phillip 2 - UMDCTF'21"></p>
<p>Et voil√†, we found the flag !</p>
<h2 id=flag>Flag</h2>
<p><strong>UMDCTF-{M3g4_Ch4#g4$}</strong></p>
<p>:trollface:
<img src=/files/umdctf21/phillip2/phil2score.PNG alt="Phillip 2 - UMDCTF'21"></p>
</div>
</div>
</div>
</div>
<script src=https://code.jquery.com/jquery-3.4.1.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js integrity=sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1 crossorigin=anonymous></script>
</body>
</html>