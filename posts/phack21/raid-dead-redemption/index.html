<!doctype html><html lang=fr-fr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Tchoupa-Team</title><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.6.3/css/all.css integrity=sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/ crossorigin=anonymous><link rel=stylesheet href=https://tchoupapps.fr/css/bootstrap4-neon-glow.css><link href="https://fonts.googleapis.com/css?family=Roboto" rel=stylesheet><link rel=stylesheet href=https://tchoupapps.fr/css/main.css><link rel=stylesheet href=https://tchoupapps.fr/css/glitch.css><link rel=stylesheet href=https://tchoupapps.fr/css/menu.css><link rel=stylesheet href=https://tchoupapps.fr/css/member.css><link rel=stylesheet href=https://tchoupapps.fr/css/chall.css></head>}<body class=imgloaded><header><div class=navbar-dark><div class="container menu"><nav class="navbar px-0 navbar-expand-lg"><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNavAltMarkup aria-controls=navbarNavAltMarkup aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNavAltMarkup><div class=navbar-nav><a href=index.html class="pl-md-0 p-3 text-decoration-none"><h3 class=bold><span class=color_danger>TCHOUPA</span><span class=color_white>TEAM</span></h3></a></div><div class="navbar-nav ml-auto"><a href=/ class="p-3 text-decoration-none text-dark bold">Home</a>
<a href=/posts class="p-3 text-decoration-none text-dark bold">Writeups</a>
<a href=/about class="p-3 text-decoration-none text-dark bold">About</a></div></div></nav></div></div></header><div class="jumbotron bg-transparent mb-0 pt-3 radius-0"><div class=container><div class=row><div class=col-xl-12><h1 class="display-1 bold color_white content__title text-center"><span class=color_danger>RAID DEAD REDEMPTION</span></h1><div class=cut></div><p class="text-spacey text-center hackerFont lead" style=color:gray>P'Hack 2021 - forensic (512 pts).<br>Written by ChapeauR0uge.</p><div class=chall><h1 id=raid-dead-redemption>Raid Dead Redemption</h1><h2 id=description>Description</h2><p><img src=/files/phack21/raid-dead-redemption/raid_dead_redemption.PNG alt="Raid Dead Redemption - P&rsquo;Hack'21"></p><h2 id=solve>Solve</h2><p>Nous avons deux fichiers:</p><ul><li><code>NoticeMastok_3000.pdf</code> un pdf contenant une documentation technique.</li><li>Un zip, contenant trois fichiers binaires <code>DISK1.bin</code>, <code>DISK2.bin</code> et <code>DISK3.bin</code>.</li></ul><p>Je fait une petite analyse rapide de ces fichiers:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ ls -l
-rw-rw-r-- <span style=color:#ae81ff>1</span> chapeaurouge chapeaurouge  <span style=color:#ae81ff>662835</span> Dec <span style=color:#ae81ff>10</span> 07:56 DISK1.bin
-rw-rw-r-- <span style=color:#ae81ff>1</span> chapeaurouge chapeaurouge       <span style=color:#ae81ff>0</span> Dec <span style=color:#ae81ff>10</span> 07:56 DISK2.bin
-rw-rw-r-- <span style=color:#ae81ff>1</span> chapeaurouge chapeaurouge  <span style=color:#ae81ff>662835</span> Dec <span style=color:#ae81ff>10</span> 07:56 DISK3.bin
</code></pre></div><p>Je remarque que le fichier DISK2.bin, celà n&rsquo;est pas étonnant car les données ont été supprimé par le suspect.</p><p>En lisant la documentation technique, je découvre rapidement qu&rsquo;il s&rsquo;agit d&rsquo;une implémentation d&rsquo;un raid 5.</p><p>En lisant la documentation du RAID5, nous savons que nous avons besoin de juste faire un XOR sur les deux autres DISK, pour retrouver les données perdus.</p><p>J&rsquo;utilise donc le logiciel windows <code>xorfile</code>, qui me permet de rapidement faire un <code>xor</code> sur de gros fichiers :</p><p><img src=/files/phack21/raid-dead-redemption/xorfile.PNG alt="xorfile - P&rsquo;Hack'21"></p><p>Une rapide vérification sur le fichier, nous permet de voir que le XOR à fonctionner <code>DISK2_recovered.bin</code>.</p><p>Maintenant nous devons réassembler les fichiers, nous devons donc reconstruire le mapping de la table, pour se faire nous avons la documentation technique:</p><ul><li>Left-Asynchronous</li><li>Lecture de droite à gauche</li><li>Le bit de parité sur le DISK 3</li><li>Chunk size de 1 octet</li></ul><p>Après de très longues et fastidieuse recherche nous mettons en place le mapping suivant :</p><table><thead><tr><th style=text-align:center></th><th style=text-align:center>DISK1</th><th style=text-align:center>DISK2</th><th style=text-align:center>DISK3</th></tr></thead><tbody><tr><td style=text-align:center>1</td><td style=text-align:center>BYTE 1</td><td style=text-align:center>BYTE 2</td><td style=text-align:center>PARITY</td></tr><tr><td style=text-align:center>2</td><td style=text-align:center>BYTE 3</td><td style=text-align:center>PARITY</td><td style=text-align:center>BYTE 4</td></tr><tr><td style=text-align:center>3</td><td style=text-align:center>PARITY</td><td style=text-align:center>BYTE 5</td><td style=text-align:center>BYTE 6</td></tr><tr><td style=text-align:center>&mldr;</td><td style=text-align:center>&mldr;</td><td style=text-align:center>&mldr;</td><td style=text-align:center>&mldr;</td></tr><tr><td style=text-align:center>END</td><td style=text-align:center>EOF</td><td style=text-align:center>EOF</td><td style=text-align:center>EOF</td></tr></tbody></table><p>Toutes les contraintes ci-dessus sont respectées, nous n&rsquo;avons plus qu&rsquo;à écrire un programme pour le réassemblage.</p><p>Nous avons donc écrit le programme <code>assembler.py</code>.</p><p>Après éxecution de celui-ci:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>python3 assemler.py
</code></pre></div><p>J&rsquo;ai maintenant le dump du disk au complet.</p><p>Je decide d&rsquo;utiliser <code>foremost</code> pour extraire tout les fichiers de ce dump:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>------------------------------------------------------------------
File: DISK.img
Start: Mon Apr  <span style=color:#ae81ff>5</span> 14:47:11 <span style=color:#ae81ff>2021</span>
Length: <span style=color:#ae81ff>1</span> MB <span style=color:#f92672>(</span><span style=color:#ae81ff>1325670</span> bytes<span style=color:#f92672>)</span>
 
Num	 Name <span style=color:#f92672>(</span>bs<span style=color:#f92672>=</span>512<span style=color:#f92672>)</span>	       Size	 File Offset	 Comment 

0:	00000145.jpg 	       <span style=color:#ae81ff>8</span> KB 	      <span style=color:#ae81ff>74408</span> 	 
1:	00000163.jpg 	      <span style=color:#ae81ff>33</span> KB 	      <span style=color:#ae81ff>83576</span> 	 
2:	00000230.jpg 	      <span style=color:#ae81ff>33</span> KB 	     <span style=color:#ae81ff>118019</span> 	 
3:	00000693.jpg 	      <span style=color:#ae81ff>11</span> KB 	     <span style=color:#ae81ff>355137</span> 	 
4:	00000716.jpg 	      <span style=color:#ae81ff>11</span> KB 	     <span style=color:#ae81ff>366800</span> 	 
5:	00000738.jpg 	       <span style=color:#ae81ff>6</span> KB 	     <span style=color:#ae81ff>378069</span> 	 
6:	00000752.jpg 	      <span style=color:#ae81ff>28</span> KB 	     <span style=color:#ae81ff>385213</span> 	 
7:	00001100.jpg 	      <span style=color:#ae81ff>17</span> KB 	     <span style=color:#ae81ff>563574</span> 	 
8:	00001134.jpg 	      <span style=color:#ae81ff>25</span> KB 	     <span style=color:#ae81ff>581100</span> 	 
9:	00001186.jpg 	      <span style=color:#ae81ff>34</span> KB 	     <span style=color:#ae81ff>607329</span> 	 
10:	00001254.jpg 	       <span style=color:#ae81ff>8</span> KB 	     <span style=color:#ae81ff>642179</span> 	 
11:	00001271.jpg 	      <span style=color:#ae81ff>13</span> KB 	     <span style=color:#ae81ff>650904</span> 	 
12:	00001415.jpg 	       <span style=color:#ae81ff>3</span> KB 	     <span style=color:#ae81ff>724988</span> 	 
13:	00001423.jpg 	       <span style=color:#ae81ff>8</span> KB 	     <span style=color:#ae81ff>728769</span> 	 
14:	00001440.jpg 	      <span style=color:#ae81ff>17</span> KB 	     <span style=color:#ae81ff>737696</span> 	 
15:	00001476.jpg 	       <span style=color:#ae81ff>9</span> KB 	     <span style=color:#ae81ff>755920</span> 	 
16:	00001844.jpg 	      <span style=color:#ae81ff>13</span> KB 	     <span style=color:#ae81ff>944220</span> 	 
17:	00001871.jpg 	       <span style=color:#ae81ff>9</span> KB 	     <span style=color:#ae81ff>958049</span> 	 
18:	00001889.jpg 	      <span style=color:#ae81ff>16</span> KB 	     <span style=color:#ae81ff>967420</span> 	 
19:	00001923.jpg 	      <span style=color:#ae81ff>12</span> KB 	     <span style=color:#ae81ff>984715</span> 	 
20:	00001947.jpg 	       <span style=color:#ae81ff>3</span> KB 	     <span style=color:#ae81ff>997285</span> 	 
21:	00001954.jpg 	       <span style=color:#ae81ff>6</span> KB 	    <span style=color:#ae81ff>1000562</span> 	 
22:	00001967.jpg 	       <span style=color:#ae81ff>3</span> KB 	    <span style=color:#ae81ff>1007602</span> 	 
23:	00001975.jpg 	      <span style=color:#ae81ff>17</span> KB 	    <span style=color:#ae81ff>1011443</span> 	 
24:	00002368.jpg 	      <span style=color:#ae81ff>16</span> KB 	    <span style=color:#ae81ff>1212911</span> 	 
25:	00002401.jpg 	      <span style=color:#ae81ff>16</span> KB 	    <span style=color:#ae81ff>1229816</span> 	 
26:	00002435.jpg 	      <span style=color:#ae81ff>10</span> KB 	    <span style=color:#ae81ff>1247183</span> 	 
27:	00002456.jpg 	      <span style=color:#ae81ff>16</span> KB 	    <span style=color:#ae81ff>1257632</span> 	 
28:	00002488.jpg 	       <span style=color:#ae81ff>3</span> KB 	    <span style=color:#ae81ff>1274241</span> 	 
29:	00002495.jpg 	      <span style=color:#ae81ff>29</span> KB 	    <span style=color:#ae81ff>1277556</span> 	 
30:	00002554.jpg 	      <span style=color:#ae81ff>17</span> KB 	    <span style=color:#ae81ff>1307793</span> 	 
31:	00000000.png 	      <span style=color:#ae81ff>72</span> KB 	          <span style=color:#ae81ff>0</span> 	  <span style=color:#f92672>(</span><span style=color:#ae81ff>681</span> x 498<span style=color:#f92672>)</span>
32:	00000297.png 	      <span style=color:#ae81ff>97</span> KB 	     <span style=color:#ae81ff>152544</span> 	  <span style=color:#f92672>(</span><span style=color:#ae81ff>439</span> x 289<span style=color:#f92672>)</span>
33:	00000492.png 	     <span style=color:#ae81ff>100</span> KB 	     <span style=color:#ae81ff>251963</span> 	  <span style=color:#f92672>(</span><span style=color:#ae81ff>640</span> x 455<span style=color:#f92672>)</span>
34:	00000808.png 	     <span style=color:#ae81ff>145</span> KB 	     <span style=color:#ae81ff>414115</span> 	  <span style=color:#f92672>(</span><span style=color:#ae81ff>900</span> x 900<span style=color:#f92672>)</span>
35:	00001297.png 	      <span style=color:#ae81ff>59</span> KB 	     <span style=color:#ae81ff>664443</span> 	  <span style=color:#f92672>(</span><span style=color:#ae81ff>400</span> x 400<span style=color:#f92672>)</span>
36:	00001494.png 	     <span style=color:#ae81ff>174</span> KB 	     <span style=color:#ae81ff>765398</span> 	  <span style=color:#f92672>(</span><span style=color:#ae81ff>640</span> x 600<span style=color:#f92672>)</span>
37:	00002010.png 	     <span style=color:#ae81ff>179</span> KB 	    <span style=color:#ae81ff>1029126</span> 	  <span style=color:#f92672>(</span><span style=color:#ae81ff>490</span> x 309<span style=color:#f92672>)</span>
Finish: Mon Apr  <span style=color:#ae81ff>5</span> 14:47:11 <span style=color:#ae81ff>2021</span>

<span style=color:#ae81ff>38</span> FILES EXTRACTED
	
jpg:<span style=color:#f92672>=</span> <span style=color:#ae81ff>31</span>
png:<span style=color:#f92672>=</span> <span style=color:#ae81ff>7</span>
------------------------------------------------------------------

Foremost finished at Mon Apr  <span style=color:#ae81ff>5</span> 14:47:11 <span style=color:#ae81ff>2021</span>
</code></pre></div><p>Il y a beaucoup de photos à l&rsquo;intérieur, j&rsquo;ouvre donc les images une à une et je tombe sur le flag:
<img src=/files/phack21/raid-dead-redemption/flag.jpg alt="Joker - P&rsquo;Hack'21"></p><h2 id=flag>Flag</h2><p><strong>PHACK{R41d_1s_N1cE_7hANk_U2_m4s7ok_3000!!}</strong></p></div></div></div></div><script src=https://code.jquery.com/jquery-3.4.1.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js integrity=sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1 crossorigin=anonymous></script></body></html>